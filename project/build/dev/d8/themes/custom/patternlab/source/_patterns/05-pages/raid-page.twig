{% extends "@templates/site-layout.twig" %}

{% block content %}

  {# Top stats/actions for a raid page #}
  {% embed "@atoms/layout/section-container.twig" with { name: 'raid-top' } %}
    {% block section_container_content %}

      {% embed '@atoms/layout/columns-8-4.twig' with { name: 'raid-top' } %}
        {% block first %}

          <h2 class="title">{{ 'Latest'|t }}</h2>

          {% for pinned_post in nodes[:1] %}
            {# Move the following logic to a single template (do this in tracker #}
            {% set type = pinned_post.type == 'media' ? 'media' : 'default' %}
            {% include "@molecules/cards/card-tracker-" ~ type ~ ".twig" with pinned_post %}
          {% endfor %}

        {% endblock first %}

        {% block second %}
          <h2 class="title">{{ 'Events'|t }}</h2>

          {% include '@molecules/cards/card-tracker-default.twig' with {
            type: 'event',
            img: false,
            card_vertical: true
          } %}

        {% endblock %}
      {% endembed %}

      <div class="row">
        <div class="col-sm-12">
          <h2 class="title text-center">Progress</h2>
        </div>
      </div>

    {% endblock %}
  {% endembed %}

  {# Raid member grid #}
  {% embed "@atoms/layout/full-bg.twig" with
    {
      name: 'raid-members',
      image_path: paths.images ~ '/backgrounds/priest-hall.jpg',
    }
  %}
    {% block full_bg_content %}
      <div class="row">
        <div class="col-sm-12">
          <h2 class="title text-center">{{ characters|length }} {{ 'Members'|t }}</h2>
        </div>
      </div>

      <div class="row">
        {% for character in characters %}
          <div class="col-sm-2">
            {% include "@molecules/character/raid-member/raid-member.twig" with {
              'character': character
            } %}
          </div>
        {% endfor %}
      </div>
    {% endblock %}
  {% endembed %}

  {# Raid bottom for news and stuff #}
  {% embed "@atoms/layout/section-container.twig" with { name: 'raid-bottom' } %}
    {% block section_container_content %}
      <div class="row">
        <div class="col-sm-4">
          <h2 class="title">All Raid Posts</h2>
          {# Take 6 posts off and merge with sidebar values #}
          {% for node in nodes[:6] %}
            {% include '@molecules/cards/card-list.twig' with node %}
          {% endfor %}

          <div class="text-center">
            {% include '@atoms/buttons/button.twig' with {
              button_text: "Read More",
              button_color: "primary",
              button_round: true,
              button_icon: "post"
            } %}
          </div>

        </div>
      </div>
    {% endblock %}
  {% endembed %}

{% endblock content %}

{% block sub %}
  {% embed '@atoms/layout/section-container.twig' with { 'name': 'raid-activity' } %}
  {% endembed %}
{% endblock %}
